2025-06-10 13:37:13 [main] INFO  c.bhuang.service.WeatherServiceTest - Starting WeatherServiceTest using Java 17.0.8.1 with PID 65027 (started by bhuang in /Users/bhuang/code/spring-ai-demo/Bhuang-MCP-Server-SSE)
2025-06-10 13:37:13 [main] DEBUG c.bhuang.service.WeatherServiceTest - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-10 13:37:13 [main] INFO  c.bhuang.service.WeatherServiceTest - The following 1 profile is active: "test"
2025-06-10 13:37:13 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable tools capabilities, notification: true
2025-06-10 13:37:13 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Registered tools: 4
2025-06-10 13:37:13 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable resources capabilities, notification: true
2025-06-10 13:37:13 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable prompts capabilities, notification: true
2025-06-10 13:37:13 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable completions capabilities
2025-06-10 13:37:14 [main] INFO  c.bhuang.service.WeatherServiceTest - Started WeatherServiceTest in 0.849 seconds (process running for 1.556)
2025-06-10 13:37:14 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-06-10 13:49:08 [main] INFO  c.bhuang.endpoints.SseEndpointTest - Starting SseEndpointTest using Java 17.0.13 with PID 69543 (started by bhuang in /Users/bhuang/code/spring-ai-demo/Bhuang-MCP-Server-SSE)
2025-06-10 13:49:08 [main] DEBUG c.bhuang.endpoints.SseEndpointTest - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-10 13:49:08 [main] INFO  c.bhuang.endpoints.SseEndpointTest - The following 1 profile is active: "test"
2025-06-10 13:49:09 [main] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - 1 RouterFunction(s) in 'routerFunctionMapping'
2025-06-10 13:49:09 [main] DEBUG o.s.w.r.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-06-10 13:49:09 [main] DEBUG o.s.w.r.r.m.a.ControllerMethodResolver - ControllerAdvice beans: none
2025-06-10 13:49:09 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable tools capabilities, notification: true
2025-06-10 13:49:09 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Registered tools: 4
2025-06-10 13:49:09 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable resources capabilities, notification: true
2025-06-10 13:49:09 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable prompts capabilities, notification: true
2025-06-10 13:49:09 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable completions capabilities
2025-06-10 13:49:09 [main] INFO  o.s.b.w.e.netty.NettyWebServer - Netty started on port 59721 (http)
2025-06-10 13:49:09 [main] INFO  c.bhuang.endpoints.SseEndpointTest - Started SseEndpointTest in 1.233 seconds (process running for 1.758)
2025-06-10 13:49:10 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [87220f1] HTTP GET /sse
2025-06-10 13:49:10 [parallel-1] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [3f5e7014] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1404/0x00000004014b2708@598dbcb4
2025-06-10 13:49:10 [parallel-1] DEBUG o.s.w.r.f.client.ExchangeFunctions - [87220f1] [47c51bcc] Response 200 OK
2025-06-10 13:49:15 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [736788b] HTTP GET /sse
2025-06-10 13:49:15 [parallel-2] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [1dfdac22] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1404/0x00000004014b2708@598dbcb4
2025-06-10 13:49:15 [parallel-2] DEBUG o.s.w.r.f.client.ExchangeFunctions - [736788b] [133a41ed] Response 200 OK
2025-06-10 13:49:45 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [27a0e6ce] HTTP GET /sse
2025-06-10 13:49:45 [parallel-3] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [3af0686f] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1404/0x00000004014b2708@598dbcb4
2025-06-10 13:49:45 [parallel-3] DEBUG o.s.w.r.f.client.ExchangeFunctions - [27a0e6ce] [34379141] Response 200 OK
2025-06-10 13:49:50 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [6c36051c] HTTP POST /sse
2025-06-10 13:49:50 [parallel-4] DEBUG o.s.w.r.h.SimpleUrlHandlerMapping - [4e66b3d4] Mapped to ResourceWebHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/]]
2025-06-10 13:49:50 [parallel-4] DEBUG o.s.w.r.resource.ResourceWebHandler - [4e66b3d4] Resource not found
2025-06-10 13:49:50 [parallel-4] DEBUG o.s.w.r.f.client.ExchangeFunctions - [6c36051c] [4cbf5cb] Response 404 NOT_FOUND
2025-06-10 13:49:50 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [1a4cbcc6] HTTP GET /sse
2025-06-10 13:49:50 [parallel-5] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [4c07b8eb] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1404/0x00000004014b2708@598dbcb4
2025-06-10 13:49:50 [parallel-5] DEBUG o.s.w.r.f.client.ExchangeFunctions - [1a4cbcc6] [42c04f1b] Response 200 OK
2025-06-10 13:49:50 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.netty.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-10 13:49:50 [netty-shutdown] INFO  o.s.b.w.e.netty.GracefulShutdown - Graceful shutdown complete
2025-06-10 13:50:04 [main] INFO  c.b.endpoints.MessageEndpointTest - Starting MessageEndpointTest using Java 17.0.13 with PID 69913 (started by bhuang in /Users/bhuang/code/spring-ai-demo/Bhuang-MCP-Server-SSE)
2025-06-10 13:50:04 [main] DEBUG c.b.endpoints.MessageEndpointTest - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-10 13:50:04 [main] INFO  c.b.endpoints.MessageEndpointTest - The following 1 profile is active: "test"
2025-06-10 13:50:05 [main] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - 1 RouterFunction(s) in 'routerFunctionMapping'
2025-06-10 13:50:05 [main] DEBUG o.s.w.r.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-06-10 13:50:05 [main] DEBUG o.s.w.r.r.m.a.ControllerMethodResolver - ControllerAdvice beans: none
2025-06-10 13:50:05 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable tools capabilities, notification: true
2025-06-10 13:50:05 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Registered tools: 4
2025-06-10 13:50:05 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable resources capabilities, notification: true
2025-06-10 13:50:05 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable prompts capabilities, notification: true
2025-06-10 13:50:05 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable completions capabilities
2025-06-10 13:50:05 [main] INFO  o.s.b.w.e.netty.NettyWebServer - Netty started on port 60182 (http)
2025-06-10 13:50:05 [main] INFO  c.b.endpoints.MessageEndpointTest - Started MessageEndpointTest in 0.936 seconds (process running for 1.433)
2025-06-10 13:50:05 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [6774f264] HTTP POST /mcp/messages
2025-06-10 13:50:06 [parallel-1] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [650a4dc1] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1410/0x00000003014b6e00@5c595f52
2025-06-10 13:50:06 [parallel-1] DEBUG o.s.w.r.f.client.ExchangeFunctions - [6774f264] [736faf3d] Response 400 BAD_REQUEST
2025-06-10 13:50:06 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages
> WebTestClient-Request-Id: [1]
> Content-Type: [application/json]
> Content-Length: [55]

{"method":"unsupported/method","jsonrpc":"2.0","id":99}

< 400 BAD_REQUEST Bad Request
< Content-Type: [application/json]
< Content-Length: [17607]

{"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoJust.java","lineNumber":55,"nativeMethod":false,"className":"reactor.core.publisher.MonoJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxFromMonoOperator.java","lineNumber":85,"nativeMethod":false,"className":"reactor.core.publisher.FluxFromMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxDeferContextual.java","lineNumber":57,"nativeMethod":false,"className":"reactor.core.publisher.FluxDeferContextual"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}

2025-06-10 13:50:06 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [e7d0db2] HTTP POST /mcp/messages
2025-06-10 13:50:06 [parallel-2] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [53d3fb7f] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1410/0x00000003014b6e00@5c595f52
2025-06-10 13:50:06 [parallel-2] DEBUG o.s.w.r.f.client.ExchangeFunctions - [e7d0db2] [5d140f75] Response 400 BAD_REQUEST
2025-06-10 13:50:06 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages
> WebTestClient-Request-Id: [2]
> Content-Type: [application/json]
> Content-Length: [40]

{"method":"ping","jsonrpc":"2.0","id":1}

< 400 BAD_REQUEST Bad Request
< Content-Type: [application/json]
< Content-Length: [17607]

{"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoJust.java","lineNumber":55,"nativeMethod":false,"className":"reactor.core.publisher.MonoJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxFromMonoOperator.java","lineNumber":85,"nativeMethod":false,"className":"reactor.core.publisher.FluxFromMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxDeferContextual.java","lineNumber":57,"nativeMethod":false,"className":"reactor.core.publisher.FluxDeferContextual"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}

2025-06-10 13:50:06 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [7404aff2] HTTP POST /mcp/messages
2025-06-10 13:50:06 [parallel-3] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [421f7da5] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1410/0x00000003014b6e00@5c595f52
2025-06-10 13:50:06 [parallel-3] DEBUG o.s.w.r.f.client.ExchangeFunctions - [7404aff2] [4cd88b96] Response 400 BAD_REQUEST
2025-06-10 13:50:06 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages
> WebTestClient-Request-Id: [3]
> Content-Type: [application/json]
> Content-Length: [46]

{"method":"tools/list","jsonrpc":"2.0","id":2}

< 400 BAD_REQUEST Bad Request
< Content-Type: [application/json]
< Content-Length: [17607]

{"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoJust.java","lineNumber":55,"nativeMethod":false,"className":"reactor.core.publisher.MonoJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxFromMonoOperator.java","lineNumber":85,"nativeMethod":false,"className":"reactor.core.publisher.FluxFromMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxDeferContextual.java","lineNumber":57,"nativeMethod":false,"className":"reactor.core.publisher.FluxDeferContextual"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}

2025-06-10 13:50:06 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [775edae0] HTTP POST /mcp/messages
2025-06-10 13:50:06 [parallel-4] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [660ef8e8] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1410/0x00000003014b6e00@5c595f52
2025-06-10 13:50:06 [parallel-4] DEBUG o.s.w.r.f.client.ExchangeFunctions - [775edae0] [68c91a59] Response 400 BAD_REQUEST
2025-06-10 13:50:06 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages
> WebTestClient-Request-Id: [4]
> Content-Type: [application/json]
> Content-Length: [46]

{"method":"tools/list","jsonrpc":"2.0","id":1}

< 400 BAD_REQUEST Bad Request
< Content-Type: [application/json]
< Content-Length: [17607]

{"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoJust.java","lineNumber":55,"nativeMethod":false,"className":"reactor.core.publisher.MonoJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxFromMonoOperator.java","lineNumber":85,"nativeMethod":false,"className":"reactor.core.publisher.FluxFromMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxDeferContextual.java","lineNumber":57,"nativeMethod":false,"className":"reactor.core.publisher.FluxDeferContextual"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}

2025-06-10 13:50:06 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [7747cc1b] HTTP POST /mcp/messages
2025-06-10 13:50:06 [parallel-5] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [2953a289] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1410/0x00000003014b6e00@5c595f52
2025-06-10 13:50:06 [parallel-5] DEBUG o.s.w.r.f.client.ExchangeFunctions - [7747cc1b] [1a8797e8] Response 400 BAD_REQUEST
2025-06-10 13:50:06 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages
> WebTestClient-Request-Id: [5]
> Content-Type: [application/json]
> Content-Length: [130]

{"id":3,"jsonrpc":"2.0","params":{"arguments":{"cityName":"Seattle, WA"},"name":"getWeatherForecastByCity"},"method":"tools/call"}

< 400 BAD_REQUEST Bad Request
< Content-Type: [application/json]
< Content-Length: [17607]

{"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoJust.java","lineNumber":55,"nativeMethod":false,"className":"reactor.core.publisher.MonoJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxFromMonoOperator.java","lineNumber":85,"nativeMethod":false,"className":"reactor.core.publisher.FluxFromMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxDeferContextual.java","lineNumber":57,"nativeMethod":false,"className":"reactor.core.publisher.FluxDeferContextual"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}

2025-06-10 13:50:06 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [6fc7e828] HTTP POST /mcp/messages
2025-06-10 13:50:06 [parallel-6] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [5ff8887] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1410/0x00000003014b6e00@5c595f52
2025-06-10 13:50:06 [parallel-6] DEBUG o.s.w.r.f.client.ExchangeFunctions - [6fc7e828] [b386648] Response 400 BAD_REQUEST
2025-06-10 13:50:06 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages
> WebTestClient-Request-Id: [6]
> Content-Type: [application/json]
> Content-Length: [170]

{"id":1,"jsonrpc":"2.0","params":{"protocolVersion":"2024-11-05","capabilities":{"tools":{}},"clientInfo":{"name":"test-client","version":"1.0.0"}},"method":"initialize"}

< 400 BAD_REQUEST Bad Request
< Content-Type: [application/json]
< Content-Length: [17607]

{"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoJust.java","lineNumber":55,"nativeMethod":false,"className":"reactor.core.publisher.MonoJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxFromMonoOperator.java","lineNumber":85,"nativeMethod":false,"className":"reactor.core.publisher.FluxFromMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxDeferContextual.java","lineNumber":57,"nativeMethod":false,"className":"reactor.core.publisher.FluxDeferContextual"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}

2025-06-10 13:50:06 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [26bce60d] HTTP POST /mcp/messages
2025-06-10 13:50:06 [parallel-7] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [2fc07654] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1410/0x00000003014b6e00@5c595f52
2025-06-10 13:50:06 [parallel-7] DEBUG o.s.w.r.f.client.ExchangeFunctions - [26bce60d] [21079ddc] Response 400 BAD_REQUEST
2025-06-10 13:50:06 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages
> WebTestClient-Request-Id: [1]
> Content-Type: [application/json]
> Content-Length: [48]

{"method":"tools/list","jsonrpc":"2.0","id":100}

< 400 BAD_REQUEST Bad Request
< Content-Type: [application/json]
< Content-Length: [17607]

{"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoJust.java","lineNumber":55,"nativeMethod":false,"className":"reactor.core.publisher.MonoJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxFromMonoOperator.java","lineNumber":85,"nativeMethod":false,"className":"reactor.core.publisher.FluxFromMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxDeferContextual.java","lineNumber":57,"nativeMethod":false,"className":"reactor.core.publisher.FluxDeferContextual"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}

2025-06-10 13:50:06 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [20914835] HTTP GET /mcp/messages
2025-06-10 13:50:06 [parallel-8] DEBUG o.s.w.r.h.SimpleUrlHandlerMapping - [2cb1cc5] Mapped to ResourceWebHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/]]
2025-06-10 13:50:06 [parallel-8] DEBUG o.s.w.r.resource.ResourceWebHandler - [2cb1cc5] Resource not found
2025-06-10 13:50:06 [parallel-8] DEBUG o.s.w.r.f.client.ExchangeFunctions - [20914835] [349c43c3] Response 404 NOT_FOUND
2025-06-10 13:50:06 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [1e7d3d87] HTTP POST /mcp/messages
2025-06-10 13:50:06 [parallel-9] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [528a8b84] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1410/0x00000003014b6e00@5c595f52
2025-06-10 13:50:06 [parallel-9] DEBUG o.s.w.r.f.client.ExchangeFunctions - [1e7d3d87] [5c4d6fa5] Response 400 BAD_REQUEST
2025-06-10 13:50:06 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages
> WebTestClient-Request-Id: [8]
> Content-Type: [application/json]
> Content-Length: [21]

{"invalid":"request"}

< 400 BAD_REQUEST Bad Request
< Content-Type: [application/json]
< Content-Length: [17607]

{"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoJust.java","lineNumber":55,"nativeMethod":false,"className":"reactor.core.publisher.MonoJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxFromMonoOperator.java","lineNumber":85,"nativeMethod":false,"className":"reactor.core.publisher.FluxFromMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxDeferContextual.java","lineNumber":57,"nativeMethod":false,"className":"reactor.core.publisher.FluxDeferContextual"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}

2025-06-10 13:50:06 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [72237be8] HTTP POST /mcp/messages
2025-06-10 13:50:06 [parallel-10] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [1380d261] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1410/0x00000003014b6e00@5c595f52
2025-06-10 13:50:06 [parallel-10] DEBUG o.s.w.r.f.client.ExchangeFunctions - [72237be8] [1d472e61] Response 400 BAD_REQUEST
2025-06-10 13:50:06 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages
> WebTestClient-Request-Id: [9]
> Content-Type: [application/json]
> Content-Length: [40]

{"method":"ping","jsonrpc":"2.0","id":1}

< 400 BAD_REQUEST Bad Request
< Content-Type: [application/json]
< Content-Length: [17607]

{"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoJust.java","lineNumber":55,"nativeMethod":false,"className":"reactor.core.publisher.MonoJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxFromMonoOperator.java","lineNumber":85,"nativeMethod":false,"className":"reactor.core.publisher.FluxFromMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxDeferContextual.java","lineNumber":57,"nativeMethod":false,"className":"reactor.core.publisher.FluxDeferContextual"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}

2025-06-10 13:50:06 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.netty.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-10 13:50:06 [netty-shutdown] INFO  o.s.b.w.e.netty.GracefulShutdown - Graceful shutdown complete
2025-06-10 13:50:58 [main] INFO  c.b.i.CompleteMcpWorkflowTest - Starting CompleteMcpWorkflowTest using Java 17.0.13 with PID 70261 (started by bhuang in /Users/bhuang/code/spring-ai-demo/Bhuang-MCP-Server-SSE)
2025-06-10 13:50:58 [main] DEBUG c.b.i.CompleteMcpWorkflowTest - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-10 13:50:58 [main] INFO  c.b.i.CompleteMcpWorkflowTest - The following 1 profile is active: "test"
2025-06-10 13:50:59 [main] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - 1 RouterFunction(s) in 'routerFunctionMapping'
2025-06-10 13:50:59 [main] DEBUG o.s.w.r.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-06-10 13:50:59 [main] DEBUG o.s.w.r.r.m.a.ControllerMethodResolver - ControllerAdvice beans: none
2025-06-10 13:50:59 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable tools capabilities, notification: true
2025-06-10 13:50:59 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Registered tools: 4
2025-06-10 13:50:59 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable resources capabilities, notification: true
2025-06-10 13:50:59 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable prompts capabilities, notification: true
2025-06-10 13:50:59 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable completions capabilities
2025-06-10 13:50:59 [main] INFO  o.s.b.w.e.netty.NettyWebServer - Netty started on port 60630 (http)
2025-06-10 13:50:59 [main] INFO  c.b.i.CompleteMcpWorkflowTest - Started CompleteMcpWorkflowTest in 0.884 seconds (process running for 1.312)
2025-06-10 13:51:00 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第一步：建立SSE连接
2025-06-10 13:51:00 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [7672960e] HTTP GET /sse
2025-06-10 13:51:00 [parallel-1] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [74e9d65d] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1397/0x00000070014c3cf8@21658377
2025-06-10 13:51:00 [parallel-1] DEBUG o.s.w.r.f.client.ExchangeFunctions - [7672960e] [4292c3ac] Response 200 OK
2025-06-10 13:51:00 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 接收到SSE事件: /mcp/messages?sessionId=eda51654-4acd-4dbb-928e-2b8be2378d6a
2025-06-10 13:51:00 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 获得会话ID: test-session-123
2025-06-10 13:51:00 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第二步：发送初始化请求，会话ID: test-session-123
2025-06-10 13:51:00 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [6d80e411] HTTP POST /mcp/messages
2025-06-10 13:51:00 [parallel-2] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [527f13b5] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1403/0x00000070014c8558@7b85b547
2025-06-10 13:51:00 [parallel-2] DEBUG o.s.w.r.f.client.ExchangeFunctions - [6d80e411] [5cdc3a84] Response 400 BAD_REQUEST
2025-06-10 13:51:00 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages
> WebTestClient-Request-Id: [2]
> Content-Type: [application/json]
> Content-Length: [328]

{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "initialize",
    "params": {
        "protocolVersion": "2024-11-05",
        "capabilities": {
            "tools": {}
        },
        "clientInfo": {
            "name": "test-client",
            "version": "1.0.0"
        }
    },
    "sessionId": "test-session-123"
}


< 400 BAD_REQUEST Bad Request
< Content-Type: [application/json]
< Content-Length: [17161]

{"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxJust.java","lineNumber":68,"nativeMethod":false,"className":"reactor.core.publisher.FluxJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}

2025-06-10 13:51:00 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 测试分离的连接和消息处理
2025-06-10 13:51:00 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [32d1d6c5] HTTP GET /sse
2025-06-10 13:51:00 [parallel-3] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [21f7b3b7] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1397/0x00000070014c3cf8@21658377
2025-06-10 13:51:00 [parallel-3] DEBUG o.s.w.r.f.client.ExchangeFunctions - [32d1d6c5] [2f3049f9] Response 200 OK
2025-06-10 13:51:00 [main] INFO  c.b.i.CompleteMcpWorkflowTest - SSE连接测试通过
2025-06-10 13:51:00 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [58583a2d] HTTP POST /mcp/messages
2025-06-10 13:51:00 [parallel-4] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [77b1320c] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1403/0x00000070014c8558@7b85b547
2025-06-10 13:51:00 [parallel-4] DEBUG o.s.w.r.f.client.ExchangeFunctions - [58583a2d] [7976d28a] Response 400 BAD_REQUEST
2025-06-10 13:51:00 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 预期的错误响应: {"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxJust.java","lineNumber":68,"nativeMethod":false,"className":"reactor.core.publisher.FluxJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}
2025-06-10 13:51:00 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 消息端点会话验证测试通过
2025-06-10 13:51:00 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.netty.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-10 13:51:00 [netty-shutdown] INFO  o.s.b.w.e.netty.GracefulShutdown - Graceful shutdown complete
2025-06-10 13:51:02 [SpringApplicationShutdownHook] INFO  c.b.i.CompleteMcpWorkflowTest - SSE连接关闭
2025-06-10 13:51:56 [main] INFO  c.b.i.CompleteMcpWorkflowTest - Starting CompleteMcpWorkflowTest using Java 17.0.13 with PID 70622 (started by bhuang in /Users/bhuang/code/spring-ai-demo/Bhuang-MCP-Server-SSE)
2025-06-10 13:51:56 [main] DEBUG c.b.i.CompleteMcpWorkflowTest - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-10 13:51:56 [main] INFO  c.b.i.CompleteMcpWorkflowTest - The following 1 profile is active: "test"
2025-06-10 13:51:57 [main] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - 1 RouterFunction(s) in 'routerFunctionMapping'
2025-06-10 13:51:57 [main] DEBUG o.s.w.r.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-06-10 13:51:57 [main] DEBUG o.s.w.r.r.m.a.ControllerMethodResolver - ControllerAdvice beans: none
2025-06-10 13:51:57 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable tools capabilities, notification: true
2025-06-10 13:51:57 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Registered tools: 4
2025-06-10 13:51:57 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable resources capabilities, notification: true
2025-06-10 13:51:57 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable prompts capabilities, notification: true
2025-06-10 13:51:57 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable completions capabilities
2025-06-10 13:51:57 [main] INFO  o.s.b.w.e.netty.NettyWebServer - Netty started on port 61120 (http)
2025-06-10 13:51:57 [main] INFO  c.b.i.CompleteMcpWorkflowTest - Started CompleteMcpWorkflowTest in 0.89 seconds (process running for 1.786)
2025-06-10 13:51:57 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第一步：建立SSE连接
2025-06-10 13:51:57 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [40013051] HTTP GET /sse
2025-06-10 13:51:57 [parallel-1] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [1bac77cb] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1397/0x000000b8014c3ab8@2c7f4731
2025-06-10 13:51:57 [parallel-1] DEBUG o.s.w.r.f.client.ExchangeFunctions - [40013051] [5d52d8e6] Response 200 OK
2025-06-10 13:51:57 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 接收到SSE事件: /mcp/messages?sessionId=381bf85c-89ac-4436-9e85-a93dbe0972c4
2025-06-10 13:51:57 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 获得会话ID: 381bf85c-89ac-4436-9e85-a93dbe0972c4
2025-06-10 13:51:57 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第二步：发送初始化请求，会话ID: 381bf85c-89ac-4436-9e85-a93dbe0972c4
2025-06-10 13:51:57 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [45f241df] HTTP POST /mcp/messages?sessionId=381bf85c-89ac-4436-9e85-a93dbe0972c4
2025-06-10 13:51:57 [parallel-2] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [79c75d1a] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1403/0x000000b8014c82b0@72c0ca55
2025-06-10 13:51:57 [parallel-2] INFO  i.m.server.McpAsyncServer - Client initialize request - Protocol: 2024-11-05, Capabilities: ClientCapabilities[experimental=null, roots=null, sampling=null], Info: Implementation[name=test-client, version=1.0.0]
2025-06-10 13:51:57 [parallel-2] INFO  c.b.i.CompleteMcpWorkflowTest - 接收到SSE事件: {"jsonrpc":"2.0","id":1,"result":{"protocolVersion":"2024-11-05","capabilities":{"completions":{},"logging":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"weather-service-mcp-server-test","version":"1.0.0"},"instructions":"A test MCP server that provides weather information"}}
2025-06-10 13:51:57 [parallel-2] DEBUG o.s.w.r.f.client.ExchangeFunctions - [45f241df] [32bd1f14] Response 200 OK
2025-06-10 13:51:57 [main] ERROR o.s.t.w.r.server.ExchangeResult - Request details for assertion failure:

> POST /mcp/messages?sessionId=381bf85c-89ac-4436-9e85-a93dbe0972c4
> WebTestClient-Request-Id: [2]
> Content-Type: [application/json]
> Content-Length: [291]

{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "initialize",
    "params": {
        "protocolVersion": "2024-11-05",
        "capabilities": {
            "tools": {}
        },
        "clientInfo": {
            "name": "test-client",
            "version": "1.0.0"
        }
    }
}


< 200 OK OK
< 

0 bytes of content (unknown content-type).

2025-06-10 13:51:57 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 测试分离的连接和消息处理
2025-06-10 13:51:57 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [49925d21] HTTP GET /sse
2025-06-10 13:51:57 [parallel-3] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [3aef969f] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1397/0x000000b8014c3ab8@2c7f4731
2025-06-10 13:51:57 [parallel-3] DEBUG o.s.w.r.f.client.ExchangeFunctions - [49925d21] [34287fb2] Response 200 OK
2025-06-10 13:51:57 [main] INFO  c.b.i.CompleteMcpWorkflowTest - SSE连接测试通过
2025-06-10 13:51:57 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [46ee7013] HTTP POST /mcp/messages
2025-06-10 13:51:57 [parallel-4] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [88a2174] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1403/0x000000b8014c82b0@72c0ca55
2025-06-10 13:51:58 [parallel-4] DEBUG o.s.w.r.f.client.ExchangeFunctions - [46ee7013] [6aaae783] Response 400 BAD_REQUEST
2025-06-10 13:51:58 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 预期的错误响应: {"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxJust.java","lineNumber":68,"nativeMethod":false,"className":"reactor.core.publisher.FluxJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}
2025-06-10 13:51:58 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 消息端点会话验证测试通过
2025-06-10 13:51:58 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.netty.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-10 13:51:58 [netty-shutdown] INFO  o.s.b.w.e.netty.GracefulShutdown - Graceful shutdown complete
2025-06-10 13:52:00 [SpringApplicationShutdownHook] INFO  c.b.i.CompleteMcpWorkflowTest - SSE连接关闭
2025-06-10 13:52:33 [main] INFO  c.b.i.CompleteMcpWorkflowTest - Starting CompleteMcpWorkflowTest using Java 17.0.13 with PID 70950 (started by bhuang in /Users/bhuang/code/spring-ai-demo/Bhuang-MCP-Server-SSE)
2025-06-10 13:52:33 [main] DEBUG c.b.i.CompleteMcpWorkflowTest - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-10 13:52:33 [main] INFO  c.b.i.CompleteMcpWorkflowTest - The following 1 profile is active: "test"
2025-06-10 13:52:34 [main] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - 1 RouterFunction(s) in 'routerFunctionMapping'
2025-06-10 13:52:34 [main] DEBUG o.s.w.r.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-06-10 13:52:34 [main] DEBUG o.s.w.r.r.m.a.ControllerMethodResolver - ControllerAdvice beans: none
2025-06-10 13:52:34 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable tools capabilities, notification: true
2025-06-10 13:52:34 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Registered tools: 4
2025-06-10 13:52:34 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable resources capabilities, notification: true
2025-06-10 13:52:34 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable prompts capabilities, notification: true
2025-06-10 13:52:34 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable completions capabilities
2025-06-10 13:52:34 [main] INFO  o.s.b.w.e.netty.NettyWebServer - Netty started on port 61515 (http)
2025-06-10 13:52:34 [main] INFO  c.b.i.CompleteMcpWorkflowTest - Started CompleteMcpWorkflowTest in 0.853 seconds (process running for 1.49)
2025-06-10 13:52:34 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第一步：建立SSE连接
2025-06-10 13:52:34 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [4bab78ce] HTTP GET /sse
2025-06-10 13:52:34 [parallel-1] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [25d7d4b6] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1397/0x000000f8014c3ab8@2c0963a4
2025-06-10 13:52:34 [parallel-1] DEBUG o.s.w.r.f.client.ExchangeFunctions - [4bab78ce] [46f4a030] Response 200 OK
2025-06-10 13:52:34 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 接收到SSE事件: /mcp/messages?sessionId=abc999a1-b888-4397-9812-60b3bdaca748
2025-06-10 13:52:34 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 获得会话ID: abc999a1-b888-4397-9812-60b3bdaca748
2025-06-10 13:52:34 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第二步：发送初始化请求，会话ID: abc999a1-b888-4397-9812-60b3bdaca748
2025-06-10 13:52:34 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [32caae19] HTTP POST /mcp/messages?sessionId=abc999a1-b888-4397-9812-60b3bdaca748
2025-06-10 13:52:34 [parallel-2] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [4d7d05c5] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1403/0x000000f8014c82b0@515350f8
2025-06-10 13:52:34 [parallel-2] INFO  i.m.server.McpAsyncServer - Client initialize request - Protocol: 2024-11-05, Capabilities: ClientCapabilities[experimental=null, roots=null, sampling=null], Info: Implementation[name=test-client, version=1.0.0]
2025-06-10 13:52:34 [parallel-2] INFO  c.b.i.CompleteMcpWorkflowTest - 接收到SSE事件: {"jsonrpc":"2.0","id":1,"result":{"protocolVersion":"2024-11-05","capabilities":{"completions":{},"logging":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"weather-service-mcp-server-test","version":"1.0.0"},"instructions":"A test MCP server that provides weather information"}}
2025-06-10 13:52:34 [parallel-2] DEBUG o.s.w.r.f.client.ExchangeFunctions - [32caae19] [6517aa4e] Response 200 OK
2025-06-10 13:52:34 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 初始化请求发送成功，状态: 200 OK
2025-06-10 13:52:34 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第三步：获取工具列表
2025-06-10 13:52:34 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [45f0038] HTTP POST /mcp/messages?sessionId=abc999a1-b888-4397-9812-60b3bdaca748
2025-06-10 13:52:34 [parallel-3] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [6b1185a5] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1403/0x000000f8014c82b0@515350f8
2025-06-10 13:53:04 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [45f0038] Cancel signal (to close connection)
2025-06-10 13:53:05 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 测试分离的连接和消息处理
2025-06-10 13:53:05 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [7cecab19] HTTP GET /sse
2025-06-10 13:53:05 [parallel-4] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [723cc082] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1397/0x000000f8014c3ab8@2c0963a4
2025-06-10 13:53:05 [parallel-4] DEBUG o.s.w.r.f.client.ExchangeFunctions - [7cecab19] [7cfb30b5] Response 200 OK
2025-06-10 13:53:05 [main] INFO  c.b.i.CompleteMcpWorkflowTest - SSE连接测试通过
2025-06-10 13:53:05 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [620572db] HTTP POST /mcp/messages
2025-06-10 13:53:05 [parallel-5] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [c3ad528] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1403/0x000000f8014c82b0@515350f8
2025-06-10 13:53:05 [parallel-5] DEBUG o.s.w.r.f.client.ExchangeFunctions - [620572db] [495b34fa] Response 400 BAD_REQUEST
2025-06-10 13:53:05 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 预期的错误响应: {"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxJust.java","lineNumber":68,"nativeMethod":false,"className":"reactor.core.publisher.FluxJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.13","methodName":"run","fileName":"Thread.java","lineNumber":840,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}
2025-06-10 13:53:05 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 消息端点会话验证测试通过
2025-06-10 13:53:05 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.netty.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-10 13:53:05 [netty-shutdown] INFO  o.s.b.w.e.netty.GracefulShutdown - Graceful shutdown complete
2025-06-10 13:53:07 [SpringApplicationShutdownHook] INFO  c.b.i.CompleteMcpWorkflowTest - SSE连接关闭
2025-06-10 13:54:10 [main] INFO  c.b.i.CompleteMcpWorkflowTest - Starting CompleteMcpWorkflowTest using Java 17.0.8.1 with PID 71352 (started by bhuang in /Users/bhuang/code/spring-ai-demo/Bhuang-MCP-Server-SSE)
2025-06-10 13:54:10 [main] DEBUG c.b.i.CompleteMcpWorkflowTest - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-10 13:54:10 [main] INFO  c.b.i.CompleteMcpWorkflowTest - The following 1 profile is active: "test"
2025-06-10 13:54:11 [main] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - 1 RouterFunction(s) in 'routerFunctionMapping'
2025-06-10 13:54:11 [main] DEBUG o.s.w.r.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-06-10 13:54:11 [main] DEBUG o.s.w.r.r.m.a.ControllerMethodResolver - ControllerAdvice beans: none
2025-06-10 13:54:11 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable tools capabilities, notification: true
2025-06-10 13:54:11 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Registered tools: 4
2025-06-10 13:54:11 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable resources capabilities, notification: true
2025-06-10 13:54:11 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable prompts capabilities, notification: true
2025-06-10 13:54:11 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable completions capabilities
2025-06-10 13:54:11 [main] INFO  o.s.b.w.e.netty.NettyWebServer - Netty started on port 62345 (http)
2025-06-10 13:54:11 [main] INFO  c.b.i.CompleteMcpWorkflowTest - Started CompleteMcpWorkflowTest in 0.825 seconds (process running for 1.372)
2025-06-10 13:54:11 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第一步：建立SSE连接
2025-06-10 13:54:11 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [6e67a8c0] HTTP GET /sse
2025-06-10 13:54:11 [parallel-1] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [6c3187d9] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1411/0x0000007001581e08@7da7358d
2025-06-10 13:54:11 [parallel-1] DEBUG o.s.w.r.f.client.ExchangeFunctions - [6e67a8c0] [2aabe793] Response 200 OK
2025-06-10 13:54:11 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 接收到SSE事件: /mcp/messages?sessionId=e12122ba-f4ee-4f0c-8834-04fef4ae12b7
2025-06-10 13:54:11 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 获得会话ID: e12122ba-f4ee-4f0c-8834-04fef4ae12b7
2025-06-10 13:54:11 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第二步：发送初始化请求，会话ID: e12122ba-f4ee-4f0c-8834-04fef4ae12b7
2025-06-10 13:54:11 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [1214c98b] HTTP POST /mcp/messages?sessionId=e12122ba-f4ee-4f0c-8834-04fef4ae12b7
2025-06-10 13:54:11 [parallel-2] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [7b99b1fd] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1417/0x0000007001586500@44468861
2025-06-10 13:54:12 [parallel-2] INFO  i.m.server.McpAsyncServer - Client initialize request - Protocol: 2024-11-05, Capabilities: ClientCapabilities[experimental=null, roots=null, sampling=null], Info: Implementation[name=test-client, version=1.0.0]
2025-06-10 13:54:12 [parallel-2] INFO  c.b.i.CompleteMcpWorkflowTest - 接收到SSE事件: {"jsonrpc":"2.0","id":1,"result":{"protocolVersion":"2024-11-05","capabilities":{"completions":{},"logging":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"weather-service-mcp-server-test","version":"1.0.0"},"instructions":"A test MCP server that provides weather information"}}
2025-06-10 13:54:12 [parallel-2] DEBUG o.s.w.r.f.client.ExchangeFunctions - [1214c98b] [18c01c0] Response 200 OK
2025-06-10 13:54:12 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 初始化请求发送成功，状态: 200 OK
2025-06-10 13:54:12 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第三步：获取工具列表
2025-06-10 13:54:12 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [28b2e4d8] HTTP POST /mcp/messages?sessionId=e12122ba-f4ee-4f0c-8834-04fef4ae12b7
2025-06-10 13:54:12 [parallel-3] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [1f6e104c] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1417/0x0000007001586500@44468861
2025-06-10 13:54:42 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [28b2e4d8] Cancel signal (to close connection)
2025-06-10 13:54:42 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 测试分离的连接和消息处理
2025-06-10 13:54:42 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [4c8abec7] HTTP GET /sse
2025-06-10 13:54:42 [parallel-4] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [52165ff0] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1411/0x0000007001581e08@7da7358d
2025-06-10 13:54:42 [parallel-4] DEBUG o.s.w.r.f.client.ExchangeFunctions - [4c8abec7] [2ac2712c] Response 200 OK
2025-06-10 13:54:42 [main] INFO  c.b.i.CompleteMcpWorkflowTest - SSE连接测试通过
2025-06-10 13:54:42 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [72e36677] HTTP POST /mcp/messages
2025-06-10 13:54:42 [parallel-5] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [38848670] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1417/0x0000007001586500@44468861
2025-06-10 13:54:42 [parallel-5] DEBUG o.s.w.r.f.client.ExchangeFunctions - [72e36677] [4e7ab77] Response 400 BAD_REQUEST
2025-06-10 13:54:42 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 预期的错误响应: {"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxJust.java","lineNumber":68,"nativeMethod":false,"className":"reactor.core.publisher.FluxJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"run$$$capture","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"run","fileName":"FutureTask.java","lineNumber":-1,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"run","fileName":"Thread.java","lineNumber":833,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}
2025-06-10 13:54:42 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 消息端点会话验证测试通过
2025-06-10 13:54:42 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.netty.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-10 13:54:42 [netty-shutdown] INFO  o.s.b.w.e.netty.GracefulShutdown - Graceful shutdown complete
2025-06-10 13:54:44 [SpringApplicationShutdownHook] INFO  c.b.i.CompleteMcpWorkflowTest - SSE连接关闭
2025-06-10 14:01:32 [main] INFO  c.b.i.CompleteMcpWorkflowTest - Starting CompleteMcpWorkflowTest using Java 17.0.8.1 with PID 73773 (started by bhuang in /Users/bhuang/code/spring-ai-demo/Bhuang-MCP-Server-SSE)
2025-06-10 14:01:32 [main] DEBUG c.b.i.CompleteMcpWorkflowTest - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-10 14:01:32 [main] INFO  c.b.i.CompleteMcpWorkflowTest - The following 1 profile is active: "test"
2025-06-10 14:01:32 [main] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - 1 RouterFunction(s) in 'routerFunctionMapping'
2025-06-10 14:01:32 [main] DEBUG o.s.w.r.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-06-10 14:01:32 [main] DEBUG o.s.w.r.r.m.a.ControllerMethodResolver - ControllerAdvice beans: none
2025-06-10 14:01:32 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable tools capabilities, notification: true
2025-06-10 14:01:32 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Registered tools: 4
2025-06-10 14:01:32 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable resources capabilities, notification: true
2025-06-10 14:01:32 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable prompts capabilities, notification: true
2025-06-10 14:01:32 [main] INFO  o.s.a.m.s.a.McpServerAutoConfiguration - Enable completions capabilities
2025-06-10 14:01:32 [main] INFO  o.s.b.w.e.netty.NettyWebServer - Netty started on port 64591 (http)
2025-06-10 14:01:33 [main] INFO  c.b.i.CompleteMcpWorkflowTest - Started CompleteMcpWorkflowTest in 0.923 seconds (process running for 1.395)
2025-06-10 14:01:35 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第一步：建立SSE连接
2025-06-10 14:01:35 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [5b23c1f6] HTTP GET /sse
2025-06-10 14:01:35 [parallel-1] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [65d0f343] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1411/0x000000a80154f088@7dfebb1
2025-06-10 14:01:35 [parallel-1] DEBUG o.s.w.r.f.client.ExchangeFunctions - [5b23c1f6] [1980a28d] Response 200 OK
2025-06-10 14:01:35 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 接收到SSE事件: /mcp/messages?sessionId=763e68c6-027c-4e04-9176-91c7a548554f
2025-06-10 14:01:35 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 获得会话ID: 763e68c6-027c-4e04-9176-91c7a548554f
2025-06-10 14:01:35 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第二步：发送初始化请求，会话ID: 763e68c6-027c-4e04-9176-91c7a548554f
2025-06-10 14:01:35 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [d180961] HTTP POST /mcp/messages?sessionId=763e68c6-027c-4e04-9176-91c7a548554f
2025-06-10 14:01:35 [parallel-2] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [74588db3] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1417/0x000000a801553788@10ad2c98
2025-06-10 14:01:35 [parallel-2] INFO  i.m.server.McpAsyncServer - Client initialize request - Protocol: 2024-11-05, Capabilities: ClientCapabilities[experimental=null, roots=null, sampling=null], Info: Implementation[name=test-client, version=1.0.0]
2025-06-10 14:01:35 [parallel-2] INFO  c.b.i.CompleteMcpWorkflowTest - 接收到SSE事件: {"jsonrpc":"2.0","id":1,"result":{"protocolVersion":"2024-11-05","capabilities":{"completions":{},"logging":{},"prompts":{"listChanged":true},"resources":{"subscribe":false,"listChanged":true},"tools":{"listChanged":true}},"serverInfo":{"name":"weather-service-mcp-server-test","version":"1.0.0"},"instructions":"A test MCP server that provides weather information"}}
2025-06-10 14:01:35 [parallel-2] DEBUG o.s.w.r.f.client.ExchangeFunctions - [d180961] [15184a4c] Response 200 OK
2025-06-10 14:01:35 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 初始化请求发送成功，状态: 200 OK
2025-06-10 14:01:35 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 第三步：获取工具列表
2025-06-10 14:01:35 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [474619d9] HTTP POST /mcp/messages?sessionId=763e68c6-027c-4e04-9176-91c7a548554f
2025-06-10 14:01:35 [parallel-3] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [1347912c] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1417/0x000000a801553788@10ad2c98
2025-06-10 14:02:05 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [474619d9] Cancel signal (to close connection)
2025-06-10 14:02:05 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 测试分离的连接和消息处理
2025-06-10 14:02:05 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [74e4be21] HTTP GET /sse
2025-06-10 14:02:05 [parallel-4] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [3c03b1b7] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1411/0x000000a80154f088@7dfebb1
2025-06-10 14:02:05 [parallel-4] DEBUG o.s.w.r.f.client.ExchangeFunctions - [74e4be21] [51fd0f7] Response 200 OK
2025-06-10 14:02:05 [main] INFO  c.b.i.CompleteMcpWorkflowTest - SSE连接测试通过
2025-06-10 14:02:05 [main] DEBUG o.s.w.r.f.client.ExchangeFunctions - [c30f26d] HTTP POST /mcp/messages
2025-06-10 14:02:05 [parallel-5] DEBUG o.s.w.r.f.s.s.RouterFunctionMapping - [d2ac7ff] Mapped to io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider$$Lambda$1417/0x000000a801553788@10ad2c98
2025-06-10 14:02:05 [parallel-5] DEBUG o.s.w.r.f.client.ExchangeFunctions - [c30f26d] [6b29d864] Response 400 BAD_REQUEST
2025-06-10 14:02:05 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 预期的错误响应: {"cause":null,"stackTrace":[{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleMessage","fileName":"WebFluxSseServerTransportProvider.java","lineNumber":304,"nativeMethod":false,"className":"io.modelcontextprotocol.server.transport.WebFluxSseServerTransportProvider"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handle","fileName":"HandlerFunctionAdapter.java","lineNumber":61,"nativeMethod":false,"className":"org.springframework.web.reactive.function.server.support.HandlerFunctionAdapter"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"handleRequestWith","fileName":"DispatcherHandler.java","lineNumber":207,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$handle$2","fileName":"DispatcherHandler.java","lineNumber":154,"nativeMethod":false,"className":"org.springframework.web.reactive.DispatcherHandler"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":132,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxOnErrorResume.java","lineNumber":79,"nativeMethod":false,"className":"reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxMap.java","lineNumber":122,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxPeek.java","lineNumber":200,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoNext.java","lineNumber":82,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"innerNext","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":259,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxConcatMap.java","lineNumber":865,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$ConcatMapInner"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMap.java","lineNumber":480,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMap$WeakScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxPeek.java","lineNumber":138,"nativeMethod":false,"className":"reactor.core.publisher.FluxPeek$PeekSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMap.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxMap$MapSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2330,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":339,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"MonoNext.java","lineNumber":108,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoNext.java","lineNumber":70,"nativeMethod":false,"className":"reactor.core.publisher.MonoNext$NextSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxConcatMapNoPrefetch.java","lineNumber":164,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":201,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxIterable.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.FluxIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"InternalMonoOperator.java","lineNumber":76,"nativeMethod":false,"className":"reactor.core.publisher.InternalMonoOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":53,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeNext","fileName":"MonoIgnoreThen.java","lineNumber":265,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoIgnoreThen.java","lineNumber":51,"nativeMethod":false,"className":"reactor.core.publisher.MonoIgnoreThen"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$doConnect$2","fileName":"HttpHandlerConnector.java","lineNumber":100,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$writeWith$2","fileName":"MockClientHttpRequest.java","lineNumber":128,"nativeMethod":false,"className":"org.springframework.mock.http.client.reactive.MockClientHttpRequest"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxConcatIterable.java","lineNumber":148,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable$ConcatIterableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxConcatIterable.java","lineNumber":60,"nativeMethod":false,"className":"reactor.core.publisher.FluxConcatIterable"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoFromFluxOperator.java","lineNumber":83,"nativeMethod":false,"className":"reactor.core.publisher.MonoFromFluxOperator"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"MonoFlatMap.java","lineNumber":165,"nativeMethod":false,"className":"reactor.core.publisher.MonoFlatMap$FlatMapMain"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onNext","fileName":"FluxSwitchIfEmpty.java","lineNumber":74,"nativeMethod":false,"className":"reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"complete","fileName":"Operators.java","lineNumber":2864,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"MonoSingle.java","lineNumber":180,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onComplete","fileName":"FluxMapFuseable.java","lineNumber":152,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2572,"nativeMethod":false,"className":"reactor.core.publisher.Operators$ScalarSubscription"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"FluxMapFuseable.java","lineNumber":171,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doOnRequest","fileName":"MonoSingle.java","lineNumber":103,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"request","fileName":"Operators.java","lineNumber":2931,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MonoInnerProducerBase"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"set","fileName":"Operators.java","lineNumber":2366,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"Operators.java","lineNumber":2240,"nativeMethod":false,"className":"reactor.core.publisher.Operators$MultiSubscriptionSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"MonoSingle.java","lineNumber":115,"nativeMethod":false,"className":"reactor.core.publisher.MonoSingle$SingleSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"onSubscribe","fileName":"FluxMapFuseable.java","lineNumber":96,"nativeMethod":false,"className":"reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"FluxJust.java","lineNumber":68,"nativeMethod":false,"className":"reactor.core.publisher.FluxJust"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribeWith","fileName":"Mono.java","lineNumber":4641,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4542,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4478,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"doConnect","fileName":"HttpHandlerConnector.java","lineNumber":114,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"lambda$connect$0","fileName":"HttpHandlerConnector.java","lineNumber":81,"nativeMethod":false,"className":"org.springframework.test.web.reactive.server.HttpHandlerConnector"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"MonoDefer.java","lineNumber":45,"nativeMethod":false,"className":"reactor.core.publisher.MonoDefer"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"subscribe","fileName":"Mono.java","lineNumber":4576,"nativeMethod":false,"className":"reactor.core.publisher.Mono"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"run","fileName":"MonoSubscribeOn.java","lineNumber":126,"nativeMethod":false,"className":"reactor.core.publisher.MonoSubscribeOn$SubscribeOnSubscriber"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":84,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":"app","moduleName":null,"moduleVersion":null,"methodName":"call","fileName":"WorkerTask.java","lineNumber":37,"nativeMethod":false,"className":"reactor.core.scheduler.WorkerTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"run$$$capture","fileName":"FutureTask.java","lineNumber":264,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"run","fileName":"FutureTask.java","lineNumber":-1,"nativeMethod":false,"className":"java.util.concurrent.FutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"run","fileName":"ScheduledThreadPoolExecutor.java","lineNumber":304,"nativeMethod":false,"className":"java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"runWorker","fileName":"ThreadPoolExecutor.java","lineNumber":1136,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"run","fileName":"ThreadPoolExecutor.java","lineNumber":635,"nativeMethod":false,"className":"java.util.concurrent.ThreadPoolExecutor$Worker"},{"classLoaderName":null,"moduleName":"java.base","moduleVersion":"17.0.8.1","methodName":"run","fileName":"Thread.java","lineNumber":833,"nativeMethod":false,"className":"java.lang.Thread"}],"jsonRpcError":null,"message":"Session ID missing in message endpoint","suppressed":[],"localizedMessage":"Session ID missing in message endpoint"}
2025-06-10 14:02:05 [main] INFO  c.b.i.CompleteMcpWorkflowTest - 消息端点会话验证测试通过
2025-06-10 14:02:05 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.netty.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-10 14:02:05 [netty-shutdown] INFO  o.s.b.w.e.netty.GracefulShutdown - Graceful shutdown complete
2025-06-10 14:02:07 [SpringApplicationShutdownHook] INFO  c.b.i.CompleteMcpWorkflowTest - SSE连接关闭
